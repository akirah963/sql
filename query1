SELECT SNUM, SNAME, CITY, COMM FROM SALESPEOPLE;


SELECT DISTINCT SNUM FROM ORDERS;


SELECT SNAME, COMM FROM SALESPEOPLE WHERE CITY = 'London';

SELECT * FROM CUST WHERE RATING = 100;

SELECT ONUM AS OrderNo, AMT AS Amount, ODATE AS Date FROM ORDERS;

SELECT * FROM CUST WHERE CITY = 'San Jose' AND RATING > 200;

SELECT * FROM CUST WHERE CITY = 'San Jose' OR RATING > 200;

SELECT * FROM ORDERS WHERE AMT > 1000;

SELECT SNAME, CITY FROM SALESPEOPLE WHERE CITY = 'London' AND COMM > 0.10;


SELECT * FROM CUST WHERE RATING > 100 OR CITY = 'Rome';

SELECT * FROM SALESPEOPLE WHERE CITY IN ('Barcelona', 'London');


SELECT * FROM SALESPEOPLE WHERE COMM > 0.10 AND COMM < 0.12;

SELECT * FROM CUST WHERE CITY IS NULL;

SELECT * FROM ORDERS WHERE ODATE IN ('1994-10-03', '1994-10-04');

SELECT * FROM CUST WHERE SNUM IN (
    SELECT SNUM FROM SALESPEOPLE WHERE SNAME IN ('Peel', 'Motika')
);

SELECT * FROM CUST WHERE CNAME LIKE 'A%' OR CNAME LIKE 'B%'

SELECT * FROM ORDERS WHERE AMT IS NOT NULL AND AMT > 0;


SELECT COUNT(DISTINCT SNUM) AS Salespeople_Count FROM ORDERS;


SELECT SNUM, ODATE, MAX(AMT) AS Largest_Order 
FROM ORDERS 
GROUP BY SNUM, ODATE;



SELECT SNUM, MAX(AMT) AS Largest_Order 
FROM ORDERS 
WHERE AMT > 3000 
GROUP BY SNUM;


SELECT ODATE, SUM(AMT) AS Total_Amount 
FROM ORDERS 
GROUP BY ODATE 
ORDER BY Total_Amount DESC 
LIMIT 1;


SELECT COUNT(*) AS Order_Count 
FROM ORDERS 
WHERE ODATE = '1994-10-03';




SELECT COUNT(DISTINCT CITY) AS Unique_Cities 
FROM CUST 
WHERE CITY IS NOT NULL;


SELECT CNUM, MIN(AMT) AS Smallest_Order 
FROM ORDERS 
GROUP BY CNUM;

SELECT * FROM CUST WHERE CNAME LIKE 'G%' ORDER BY CNAME ASC LIMIT 1;


SELECT DATE_FORMAT(ODATE, '%d/%m/%y') AS Order_Date, 
       CONCAT('For ', DATE_FORMAT(ODATE, '%d/%m/%y'), ' there are ', COUNT(*) , ' orders.') AS Message 
FROM ORDERS 
GROUP BY ODATE;



SELECT ONUM, SNUM, AMT * 0.12 AS Salesperson_Commission 
FROM ORDERS;


SELECT CITY, 
       CONCAT('For the city ', CITY, ', the highest rating is: ', MAX(RATING)) AS Message 
FROM CUST 
GROUP BY CITY;


SELECT ODATE, SUM(AMT) AS Total_Orders 
FROM ORDERS 
GROUP BY ODATE 
ORDER BY Total_Orders DESC;

SELECT S.SNAME AS Salesperson, C.CNAME AS Customer, S.CITY 
FROM SALESPEOPLE S 
JOIN CUST C ON S.CITY = C.CITY;

SELECT C.CNAME AS Customer, S.SNAME AS Salesperson 
FROM CUST C 
JOIN SALESPEOPLE S ON C.SNUM = S.SNUM;


SELECT O.ONUM AS Order_Number, C.CNAME AS Customer_Name 
FROM ORDERS O 
JOIN CUST C ON O.CNUM = C.CNUM;


SELECT O.ONUM AS Order_Number, S.SNAME AS Salesperson, C.CNAME AS Customer 
FROM ORDERS O 
JOIN SALESPEOPLE S ON O.SNUM = S.SNUM 
JOIN CUST C ON O.CNUM = C.CNUM;


SELECT C.* 
FROM CUST C 
JOIN SALESPEOPLE S ON C.SNUM = S.SNUM 
WHERE S.COMM > 0.12;

SELECT O.ONUM, O.AMT, S.SNUM, (O.AMT * S.COMM) AS Salesperson_Commission 
FROM ORDERS O 
JOIN CUST C ON O.CNUM = C.CNUM 
JOIN SALESPEOPLE S ON O.SNUM = S.SNUM 
WHERE C.RATING > 100;


SELECT C1.CNAME AS Customer1, C2.CNAME AS Customer2, C1.RATING 
FROM CUST C1 
JOIN CUST C2 ON C1.RATING = C2.RATING AND C1.CNUM <> C2.CNUM;



SELECT C1.CNAME AS Customer1, C2.CNAME AS Customer2, C1.RATING 
FROM CUST C1 
JOIN CUST C2 ON C1.RATING = C2.RATING AND C1.CNUM < C2.CNUM;


SELECT C.CNAME AS Customer, S1.SNAME AS Salesperson1, S2.SNAME AS Salesperson2, S3.SNAME AS Salesperson3 
FROM CUST C 
JOIN SALESPEOPLE S1 
JOIN SALESPEOPLE S2 ON S1.SNUM < S2.SNUM 
JOIN SALESPEOPLE S3 ON S2.SNUM < S3.SNUM;

SELECT * FROM CUST 
WHERE CITY IN (SELECT CITY FROM CUST WHERE SNUM = (SELECT SNUM FROM SALESPEOPLE WHERE SNAME = 'Serres'));


SELECT C1.CNAME AS Customer1, C2.CNAME AS Customer2, C1.SNUM 
FROM CUST C1 
JOIN CUST C2 ON C1.SNUM = C2.SNUM AND C1.CNUM < C2.CNUM;


SELECT S1.SNAME AS Salesperson1, S2.SNAME AS Salesperson2, S1.CITY 
FROM SALESPEOPLE S1 
JOIN SALESPEOPLE S2 ON S1.CITY = S2.CITY AND S1.SNUM < S2.SNUM;


SELECT C.CNAME AS Customer, O1.ONUM AS Order1, O2.ONUM AS Order2 
FROM ORDERS O1 
JOIN ORDERS O2 ON O1.CNUM = O2.CNUM AND O1.ONUM < O2.ONUM 
JOIN CUST C ON O1.CNUM = C.CNUM;


SELECT CNAME, CITY 
FROM CUST 
WHERE RATING = (SELECT RATING FROM CUST WHERE CNAME = 'Hoffman');



SELECT O.* 
FROM ORDERS O 
JOIN SALESPEOPLE S ON O.SNUM = S.SNUM 
WHERE S.SNAME = 'Motika';


SELECT O.* 
FROM ORDERS O 
WHERE O.SNUM = (SELECT SNUM FROM CUST WHERE CNAME = 'Hoffman');


SELECT * FROM ORDERS 
WHERE ODATE = '1994-10-04' 
AND AMT > (SELECT AVG(AMT) FROM ORDERS WHERE ODATE = '1994-10-04');



SELECT AVG(COMM) AS Avg_Commission 
FROM SALESPEOPLE 
WHERE CITY = 'London';

SELECT O.* 
FROM ORDERS O 
JOIN CUST C ON O.CNUM = C.CNUM 
WHERE C.CITY = 'London';


SELECT DISTINCT S.SNAME, S.COMM 
FROM SALESPEOPLE S 
JOIN CUST C ON S.SNUM = C.SNUM 
WHERE C.CITY = 'London';



SELECT * 
FROM CUST 
WHERE CNUM = (SELECT SNUM FROM SALESPEOPLE WHERE SNAME = 'Serres') + 1000;


SELECT COUNT(*) AS Count_Customers 
FROM CUST 
WHERE RATING > (SELECT AVG(RATING) FROM CUST WHERE CITY = 'San Jose');


SELECT O.* 
FROM ORDERS O 
WHERE CNUM = (SELECT CNUM FROM CUST WHERE CNAME = 'Cisnerous');

SELECT DISTINCT C.CNAME, C.RATING 
FROM CUST C 
JOIN ORDERS O ON C.CNUM = O.CNUM 
WHERE O.AMT > (SELECT AVG(AMT) FROM ORDERS);

SELECT SNUM, SUM(AMT) AS Total_Sales 
FROM ORDERS 
GROUP BY SNUM 
HAVING SUM(AMT) > (SELECT MAX(AMT) FROM ORDERS);


SELECT DISTINCT C.* 
FROM CUST C 
JOIN ORDERS O ON C.CNUM = O.CNUM 
WHERE O.ODATE = '1994-10-03';


SELECT S.SNUM, S.SNAME 
FROM SALESPEOPLE S 
JOIN CUST C ON S.SNUM = C.SNUM 
GROUP BY S.SNUM, S.SNAME 
HAVING COUNT(C.CNUM) > 1;



SELECT O.ONUM, C.CNAME, S.SNAME, O.SNUM, C.SNUM 
FROM ORDERS O 
JOIN CUST C ON O.CNUM = C.CNUM 
JOIN SALESPEOPLE S ON O.SNUM = S.SNUM 
WHERE O.SNUM <> C.SNUM;



SELECT O.* 
FROM ORDERS O 
WHERE O.AMT > (SELECT AVG(AMT) FROM ORDERS WHERE CNUM = O.CNUM);


SELECT ODATE, SUM(AMT) AS Total_Amount
FROM ORDERS
GROUP BY ODATE
HAVING SUM(AMT) > (SELECT MAX(AMT) FROM ORDERS) + 2000;


SELECT CNUM, CNAME, CITY, RATING
FROM CUST C1
WHERE RATING = (SELECT MAX(RATING) FROM CUST C2 WHERE C1.CITY = C2.CITY);


SELECT DISTINCT S.SNUM, S.SNAME, S.CITY
FROM SALESPEOPLE S
JOIN CUST C ON S.CITY = C.CITY
WHERE S.SNUM <> C.SNUM;


SELECT DISTINCT S.SNUM, S.SNAME, S.CITY
FROM SALESPEOPLE S
WHERE EXISTS (
    SELECT 1 FROM CUST C
    WHERE C.CITY = S.CITY AND C.SNUM <> S.SNUM
);



SELECT CNUM, CNAME, CITY
FROM CUST
WHERE EXISTS (SELECT 1 FROM CUST WHERE CITY = 'San Jose');


SELECT SNUM
FROM CUST
GROUP BY SNUM
HAVING COUNT(CNUM) > 1;

SELECT S.SNUM, S.SNAME, S.CITY
FROM SALESPEOPLE S
JOIN CUST C ON S.SNUM = C.SNUM
GROUP BY S.SNUM, S.SNAME, S.CITY
HAVING COUNT(C.CNUM) > 1;



SELECT SNUM, SNAME, CITY
FROM SALESPEOPLE
WHERE SNUM IN (
    SELECT SNUM FROM CUST GROUP BY SNUM HAVING COUNT(CNUM) = 1
);



SELECT S.*
FROM SALESPEOPLE S
JOIN ORDERS O ON S.SNUM = O.SNUM
GROUP BY S.SNUM, S.SNAME, S.CITY, S.COMM
HAVING COUNT(O.ONUM) > 1;


SELECT S.*
FROM SALESPEOPLE S
WHERE EXISTS (
    SELECT 1 FROM CUST C WHERE C.SNUM = S.SNUM AND C.RATING = 300
);


SELECT DISTINCT S.*
FROM SALESPEOPLE S
JOIN CUST C ON S.SNUM = C.SNUM
WHERE C.RATING = 300;

SELECT S.*
FROM SALESPEOPLE S
WHERE EXISTS (
    SELECT 1 FROM CUST C WHERE C.CITY = S.CITY AND C.SNUM <> S.SNUM
);


SELECT C.*
FROM CUST C
WHERE EXISTS (
    SELECT 1 FROM CUST C2
    JOIN ORDERS O ON C2.CNUM = O.CNUM
    WHERE C2.SNUM = C.SNUM AND C2.CNUM <> C.CNUM
);

SELECT S.*
FROM SALESPEOPLE S
WHERE S.CITY = ANY (SELECT CITY FROM CUST WHERE SNUM = S.SNUM);



SELECT S.*
FROM SALESPEOPLE S
WHERE S.CITY IN (SELECT CITY FROM CUST WHERE SNUM = S.SNUM);


SELECT S.*
FROM SALESPEOPLE S
WHERE EXISTS (
    SELECT 1 FROM CUST C WHERE S.SNUM = C.SNUM AND S.SNAME < C.CNAME
);


SELECT C.*
FROM CUST C
WHERE C.RATING > ANY (SELECT RATING FROM CUST WHERE CITY = 'Rome');



SELECT * 
FROM orders 
WHERE amt > ANY (SELECT amt FROM orders WHERE odate = '2024-10-06');


SELECT COUNT(DISTINCT CITY) AS Unique_Cities 
FROM CUST 
WHERE CITY IS NOT NULL;


SELECT CNUM, MIN(AMT) AS Smallest_Order 
FROM ORDERS 
GROUP BY CNUM;


SELECT O.ONUM AS Order_Number, C.CNAME AS Customer_Name 
FROM ORDERS O 
JOIN CUST C ON O.CNUM = C.CNUM;


SELECT O.ONUM AS Order_Number, S.SNAME AS Salesperson, C.CNAME AS Customer 
FROM ORDERS O 
JOIN SALESPEOPLE S ON O.SNUM = S.SNUM 
JOIN CUST C ON O.CNUM = C.CNUM;



-- Using ALL
SELECT C.CNAME
FROM CUST C
WHERE C.RATING > ALL (
    SELECT RATING
    FROM CUST
    WHERE CITY = 'Paris'
);

-- Using NOT EXISTS
SELECT C.CNAME
FROM CUST C
WHERE NOT EXISTS (
    SELECT 1
    FROM CUST C2
    WHERE C2.CITY = 'Paris' AND C2.RATING >= C.RATING
);




SELECT C.CNAME
FROM CUST C
WHERE C.RATING >= ANY (
    SELECT C2.RATING
    FROM CUST C2
    WHERE C2.CNAME = 'Seeres'
);




-- Using ANY
SELECT S.SNAME
FROM SALESPEOPLE S
WHERE NOT EXISTS (
    SELECT 1
    FROM CUST C
    WHERE C.CITY = S.CITY AND C.SNUM = S.SNUM
);

-- Using ALL
SELECT S.SNAME
FROM SALESPEOPLE S
WHERE NOT EXISTS (
    SELECT 1
    FROM CUST C
    WHERE C.CITY = S.CITY AND C.SNUM = S.SNUM
);



 SELECT O.*
FROM ORDERS O
WHERE O.AMT > ANY (
    SELECT O2.AMT
    FROM ORDERS O2
    JOIN CUST C ON O2.CNUM = C.CNUM
    WHERE C.CITY = 'London'
);



 SELECT S.SNAME, C.CNAME
FROM SALESPEOPLE S
JOIN CUST C ON S.SNUM = C.SNUM
WHERE C.CITY = 'London';





SELECT O.SNUM, 
       MAX(O.ODATE) AS MAX_ORDER_DATE, 
       MIN(O.ODATE) AS MIN_ORDER_DATE
FROM ORDERS O
GROUP BY O.SNUM;






SELECT S.SNAME,
       CASE 
           WHEN EXISTS (SELECT 1 FROM CUST C WHERE C.SNUM = S.SNUM AND C.CITY = S.CITY) THEN 'Has customers in their city'
           ELSE 'Does not have customers in their city'
       END AS CUSTOMER_STATUS
FROM SALESPEOPLE S;






 SELECT S.SNAME, 
       S.CITY,
       CONCAT(S.SNAME, ' ', 
              CASE 
                  WHEN EXISTS (SELECT 1 FROM CUST C WHERE C.SNUM = S.SNUM AND C.CITY = S.CITY) 
                  THEN 'Has customers in their city' 
                  ELSE 'Does not have customers in their city' 
              END) AS SALESPEOPLE_STATUS
FROM SALESPEOPLE S;




SELECT C.CNAME, C.CITY, C.RATING, 'High Rating' AS RATING_STATUS
FROM CUST C
WHERE C.RATING >= 200
UNION
SELECT C.CNAME, C.CITY, C.RATING, 'Low Rating' AS RATING_STATUS
FROM CUST C
WHERE C.RATING < 200;







 SELECT S.SNAME, S.SNUM, C.CNAME, C.CNUM
FROM SALESPEOPLE S
JOIN CUST C ON S.SNUM = C.SNUM
JOIN ORDERS O ON C.CNUM = O.CNUM
GROUP BY S.SNUM, C.CNUM
HAVING COUNT(O.ONUM) > 1
ORDER BY S.SNAME, C.CNAME;





(SELECT S.SNUM FROM SALESPEOPLE S WHERE S.CITY = 'San Jose')
UNION
(SELECT C.CNUM FROM CUST C WHERE C.CITY = 'San Jose')
UNION
(SELECT O.ONUM FROM ORDERS O WHERE O.ODATE = '1994-10-03');




 SELECT DISTINCT S.SNAME
FROM SALESPEOPLE S
JOIN CUST C ON S.SNUM = C.SNUM
WHERE C.CITY = 'London';




 SELECT DISTINCT S.SNAME
FROM SALESPEOPLE S
WHERE S.CITY = 'London' AND S.SNUM NOT IN (
    SELECT C.SNUM
    FROM CUST C
    WHERE C.CITY = 'London'
);




SELECT S.SNAME, C.CNAME
FROM SALESPEOPLE S
LEFT OUTER JOIN CUST C ON S.SNUM = C.SNUM
ORDER BY S.SNAME;

-- Using UNION
SELECT S.SNAME, C.CNAME
FROM SALESPEOPLE S
LEFT JOIN CUST C ON S.SNUM = C.SNUM
UNION
SELECT S.SNAME, 'No customer assigned' AS CNAME
FROM SALESPEOPLE S
WHERE S.SNUM NOT IN (SELECT C.SNUM FROM CUST C);